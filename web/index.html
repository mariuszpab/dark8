<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>DARK8 Studio - Minimal UI</title>
    <style>
      body { font-family: Arial, sans-serif; margin: 0; padding: 0; }
      #top { padding: 8px; background: #111; color: #fff; }
      #main { display: flex; height: calc(100vh - 40px); }
      #left { width: 30%; border-right: 1px solid #ddd; padding: 8px; overflow:auto }
      #right { flex: 1; padding: 8px; overflow:auto }
      textarea { width: 100%; height: 60vh; }
    </style>
  </head>
  <body>
    <div id="top">DARK8 Studio — Minimal Web UI</div>
    <div id="main">
      <div id="left">
        <h3>Agent</h3>
        <textarea id="prompt">Napisz krótki opis funkcji read_file w Python.</textarea>
        <button id="ask">Wyślij do OLLAMA</button>
        <pre id="response"></pre>
      </div>
      <div id="right">
        <h3>Editor (plik)</h3>
        <input id="path" value="README.md" style="width:100%" />
        <button id="load">Wczytaj</button>
        <button id="save">Zapisz</button>
        <textarea id="filecontent"></textarea>
      </div>
    </div>

    <script>
      const ask = document.getElementById('ask')
      ask.onclick = async () => {
        const prompt = document.getElementById('prompt').value
        const res = await fetch('/agent/chat', {method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({prompt})})
        const j = await res.json()
        document.getElementById('response').innerText = JSON.stringify(j, null, 2)
      }

      document.getElementById('load').onclick = async () => {
        const path = document.getElementById('path').value
        const res = await fetch('/fs/read?path=' + encodeURIComponent(path))
        const j = await res.json()
        if (j.type === 'file') document.getElementById('filecontent').value = j.content
        else document.getElementById('filecontent').value = '[directory]'
      }

      document.getElementById('save').onclick = async () => {
        const path = document.getElementById('path').value
        const content = document.getElementById('filecontent').value
        const res = await fetch('/fs/write?path=' + encodeURIComponent(path), {method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(content)})
        const j = await res.json()
        alert(JSON.stringify(j))
      }
    </script>
  </body>
</html>
